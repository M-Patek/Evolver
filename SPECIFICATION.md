# HYPER-TENSOR PROTOCOL (HTP): Core Protocol Specification

"The Soul evolves, the Will optimizes, the Body manifests."

## Abstract

This document defines the Hyper-Tensor Protocol (HTP). The protocol establishes an algebraic evolution mechanism based on the Ideal Class Group of Imaginary Quadratic Fields for the generation, verification, and materialization of logical paths.

**Core Transformation:**
The system transitions from a "continuous manifold approximation" to a rigorous Discrete Algebraic Graph Search. Truth is the zero-energy state found by traversing the Cayley Graph of the class group.

---

## 1. The Soul: Discrete Algebraic State Space

### 1.1 The Structure: Finite Abelian Group $Cl(\Delta)$

The core state space is not a continuous manifold, but a finite discrete Abelian group: the Ideal Class Group $Cl(\Delta)$.

* **Discriminant:** $\Delta < 0$ and $\Delta \equiv 0, 1 \pmod 4$
* **Elements:** Equivalence classes of binary quadratic forms $[a, b, c]$.
* **Topology:** Discrete topology. No intrinsic notion of "infinitesimal" exists naturally.

### 1.2 The Geometry: Cayley Graph

To define "neighborhoods" and "search directions" for the Will, we explicitly construct a Cayley Graph $\mathcal{G}$.

* **Vertices:** Elements of $Cl(\Delta)$.
* **Generating Set ($\mathcal{P}$):** A selected set of prime ideal classes (perturbations) generated by the VAPO perturber.

$$\mathcal{P} = \{ [\mathfrak{p}_1], [\mathfrak{p}_1]^{-1}, \dots, [\mathfrak{p}_k], [\mathfrak{p}_k]^{-1} \}$$

* **Metric:** The distance $d(S_1, S_2)$ is defined as the Word Metric relative to $\mathcal{P}$ — the length of the shortest path between $S_1$ and $S_2$ on the graph.

### 1.3 State Evolution Dynamics (Decoupled)

To preserve the local metric structure required for optimization (Lipschitz continuity), we explicitly decouple the **Search Dynamics** from the **Time Dynamics**.

**Search Dynamics (The Will's Walk)**
The Will operates on the static Cayley Graph. It moves from neighbor to neighbor to find the optimal seed.

$$S_{k+1} = S_k \circ \epsilon_k$$

* $S_k$: The current candidate seed at search step $k$.
* $\epsilon_k \in \mathcal{P}$: A perturbation (generator) chosen by the VAPO optimizer.

**Time Dynamics (The Observation)**
Once a candidate seed $S$ is selected (or evaluated), it is "unfolded" in time to generate the logical path. This is the VDF (Verifiable Delay Function) aspect.

$$O_0 = S$$
$$O_{t+1} = O_t^2$$

The logical path is derived from the orbit $O_0, O_1, \dots, O_T$.

---

## 2. The Will: Discrete Graph Search

### 2.1 The Optimization Objective: Unified Energy Metric

The responsibility of the Will is to navigate the Cayley Graph to find a node $S^*$ such that the projected logical path satisfies Strict Logical Truth.

To reconcile the discrete nature of logic (True/False) with the need for search guidance, we define a Unified Energy Metric $J(S)$.

$$J(S) = E_{barrier}(S) + E_{residual}(S)$$

1.  **The Discrete Barrier ($E_{barrier}$):**
    This component enforces the "Correct-by-Construction" constraints.
    * **0.0 (Valid):** The path is syntactically correct AND semantically valid (STP Energy = 0).
    * **10.0 (Syntax Error):** The projection failed to decode into a valid abstract syntax tree (AST).
    * **100.0 (Logical Violation):** The path implies a contradiction (e.g., $1+1=3$) detected by the STP engine.

2.  **The Geometric Residual ($E_{residual}$):**
    This component provides Directional Metric Guidance for the optimizer when $E_{barrier} > 0$.

    $$E_{residual}(S) = \beta \cdot ||\Psi(S) - \tau_{target}||^2$$

    Acts as a heuristic "Slope" in the Continuous Embedding space.

**Optimization Goal:**
$$\text{Minimize } J(S) \text{ subject to } S \in V(\mathcal{G})$$

**Truth Condition:**
$$S \text{ is True } \iff E_{barrier}(S) = 0$$

### 2.2 VAPO on Graphs

Since the domain is discrete and $E_{barrier}$ is a step function, Gradients $\nabla J$ are undefined. VAPO (Valuation-Adaptive Perturbation Optimization) operates as a Geometric Heuristic Search.

**The "Continuous Embedding" Heuristic:**
The efficacy of VAPO relies strictly on the Lipschitz continuity of the Projection Map $\Psi$ into a Continuous Embedding Space. Small steps in the algebraic graph must result in bounded changes in the feature space $\mathbf{F}(S)$.

* **Coarse Operators (Large Norm Primes):** Edges in $\mathcal{G}$ that correspond to generators with large algebraic norms. These tend to cause larger shifts in the embedding.
* **Fine Operators (Small Norm Primes):** Edges corresponding to small norm primes. These act as "local" adjustments.

**Search Strategy:**
1.  **Expansion:** Generate neighbors $\mathcal{N}(S_t) = \{ S_t \circ \epsilon \mid \epsilon \in \mathcal{P} \}$
2.  **Evaluation:** Compute Unified Energy $J$ for all neighbors.
3.  **Selection:** Move to the neighbor with the lowest energy (Greedy Hill Climbing on the Graph guided by the Embedding).

---

## 3. The Body: Topological Materialization

### 3.1 The Projection Map $\Psi$

> ⚠️ **DEPRECATION NOTICE (v2.1)**
> The Linear Congruence Projection (LCP) described below represents the idealized theoretical model. In practice, it suffers from "Reduction Chaos".

The current active implementation utilizes **Canonical Modular Projection**, which maps the algebraic state to invariant geometric features ($\tau$-features) before discretization.

**Canonical Modular Projection:**
To ensure Lipschitz continuity and ensure a smooth heuristic landscape, we project the geometric invariants of the ideal class in the Upper Half Plane $\mathbb{H}$.

**The Modular Point:**
For a reduced form $[a, b, c]$, the corresponding point in $\mathbb{H}$ is:

$$\tau = \frac{-b + i\sqrt{|\Delta|}}{2a} = x + iy$$

**The Continuous Feature Embedding:**
$$\mathbf{F}(S) = \begin{bmatrix} \cos(2\pi x) \\ \sin(2\pi x) \\ \log(y) \end{bmatrix}$$

This embedding $\mathbf{F}(S)$ allows the discrete optimizer to sense "direction" without requiring differentiability.

### 3.2 Semantic Adapter
Converts numerical sequences into ProofAction. This remains a deterministic mapping.

---

## 4. Security & Verifiability

### 4.1 Time Security (Hidden Path)
Security relies on the hardness of the Shortest Path Problem (or DLP) in the huge Cayley Graph of $Cl(\Delta)$. Finding the specific sequence of generators (the path) that connects $S_0$ to $S_{final}$ is computationally infeasible without the history.

### 4.2 Proof of Will
The Proof Bundle is the Path Record:

$$\text{Bundle} = \{ \text{ContextHash}, S_{final}, \text{Path} = [\epsilon_1, \epsilon_2, \dots, \epsilon_k] \}$$

Verification involves replaying the walk on the graph:
$$S_0 \xrightarrow{\epsilon_1} S_1 \dots \xrightarrow{\epsilon_k} S_{final}$$

---

## 5. Conclusion

HTP is re-specified as:
* **Soul:** A node in the Class Group Cayley Graph.
* **Will:** An agent performing heuristic search on this graph utilizing the metric continuity of the Modular Projection.
* **Body:** The discrete quantization of the modular features.

No gradients, no hallucinations, just rigorous discrete algebra guided by geometry.
